# Top Navigation Bar (Верхняя панель навигации)

## Обзор

Верхняя панель навигации — это компонент `TopBar`, который обеспечивает быстрый доступ ко всем основным функциям Timeline Studio. Панель организована в 5 групп элементов управления и предоставляет единую точку доступа к настройкам, управлению проектом, записи и экспорту.

## Структура панели (5 групп)

### Группа 1: Управление интерфейсом
- **Переключатель браузера** (`PanelLeftClose`/`PanelLeftOpen`) - показать/скрыть браузер медиафайлов
- **Выбор макета** (`Layout`) - popover с превью различных layout'ов интерфейса

### Группа 2: Настройки и конфигурация
- **Переключатель темы** (`ThemeToggle`) - светлая/темная тема
- **Горячие клавиши** (`Keyboard`) - открывает модальное окно с горячими клавишами
- **Настройки пользователя** (`UserCog`) - открывает модальное окно пользовательских настроек
- **Настройки проекта** (`Settings`) - открывает модальное окно настроек проекта

### Группа 3: Управление проектом
- **Открыть проект** (`FolderOpen`) - открытие существующего проекта
- **Сохранить проект** (`Save`) - сохранение текущего проекта (активна только при наличии изменений)
- **Название проекта** - редактируемое поле с названием текущего проекта

### Группа 4: Запись контента
- **Запись с камеры** (`Webcam`) - открывает модальное окно захвата видео с камеры
- **Запись голоса** (`Mic`) - открывает модальное окно записи голоса

### Группа 5: Публикация и экспорт
- **Публикация** (`Send`) - popover с задачами публикации
- **Задачи редактирования** (`ListTodo`) - popover с задачами проекта
- **Экспорт** (`Upload`) - кнопка экспорта проекта (выделена цветом)

## Модальные окна

### Диалог настроек проекта (`project-settings`)
- **Основные настройки** - название, разрешение, частота кадров
- **Дополнительные настройки** - цветовое пространство, аудио настройки
- **Кнопки действий** - сохранить, отменить, сбросить

### Диалог пользовательских настроек (`user-settings`)
- **Интерфейс** - размеры превью, активная вкладка, режим layout'а
- **Пути** - пути для скриншотов и медиафайлов
- **API ключи** - OpenAI и Claude API ключи
- **Плеер** - громкость и другие настройки плеера
- **Видимость** - настройки видимости браузера

### Диалог горячих клавиш (`keyboard-shortcuts`)
- **Список горячих клавиш** - все доступные комбинации клавиш
- **Категории** - группировка по функциональности
- **Поиск** - быстрый поиск нужной комбинации

### Диалог захвата камеры (`camera-capture`)
- **Выбор камеры** - список доступных камер
- **Настройки качества** - разрешение и частота кадров
- **Предпросмотр** - превью с камеры
- **Запись** - начать/остановить запись

### Диалог записи голоса (`voice-recording`)
- **Выбор микрофона** - список доступных устройств
- **Настройки аудио** - качество и формат записи
- **Визуализация** - уровень звука в реальном времени
- **Запись** - начать/остановить запись

### Диалог экспорта (`export`)
- **Формат** - выбор формата экспорта (MP4, MOV, AVI и др.)
- **Качество** - настройки качества и разрешения
- **Пресеты** - готовые настройки для разных платформ
- **Дополнительные параметры** - кодек, битрейт, метаданные
- **Кнопки действий** - экспорт, отмена, предпросмотр

## Функциональность компонентов

### Переключатель браузера
- Использует `toggleBrowserVisibility()` из `useUserSettings`
- Сохраняет состояние в пользовательских настройках
- Анимированный переход иконки между `PanelLeftClose` и `PanelLeftOpen`

### Выбор макета
- Popover с компонентом `LayoutPreviews`
- Показывает превью всех доступных layout'ов
- Позволяет переключаться между: default, options, vertical, dual

### Управление проектом
- **Открытие проекта**: вызывает `openProject()` из `useCurrentProject`
- **Сохранение**: активно только при `currentProject.isDirty === true`
- **Название проекта**: редактируемое поле с автофокусом при клике

### Модальные окна
- Все модальные окна открываются через `openModal(modalType)` из `useModal`
- Поддерживаемые типы: `project-settings`, `user-settings`, `keyboard-shortcuts`, `camera-capture`, `voice-recording`, `export`

## Примеры использования

### Открытие модального окна

```typescript
const { openModal } = useModal()

const handleOpenModal = (modal: string) => {
  console.log(`Opening modal: ${modal}`)
  openModal(modal as ModalType)
}

// Использование
<Button onClick={() => handleOpenModal("project-settings")}>
  <Settings className="h-5 w-5" />
</Button>
```

### Управление проектом

```typescript
const { currentProject, openProject, saveProject, setProjectDirty } = useCurrentProject()

const handleSave = () => {
  try {
    void saveProject(projectName)
    console.log("Project saved successfully")
  } catch (error) {
    console.error("Error saving project:", error)
  }
}

const handleOpenProject = () => {
  try {
    void openProject()
    console.log("Project opened successfully")
  } catch (error) {
    console.error("Error opening project:", error)
  }
}
```

### Переключение видимости браузера

```typescript
const { isBrowserVisible, toggleBrowserVisibility } = useUserSettings()

<Button
  onClick={toggleBrowserVisibility}
  title={isBrowserVisible ? t("browser.hide") : t("browser.show")}
>
  {isBrowserVisible ? <PanelLeftClose size={16} /> : <PanelLeftOpen size={16} />}
</Button>
```

## Планы по развитию

- Добавление поддержки тем оформления
- Улучшение отзывчивости интерфейса
- Добавление настраиваемых панелей инструментов
- Реализация системы уведомлений
- Добавление поддержки плагинов
- Интеграция с чатом и панелью выбора ИИ-моделей для редактирования схемы видео
- Добавление панели ресурсов слева от таймлайна

## Связанные документы

- [Обзор архитектуры](../overview.md)
- [Машины состояний](../state-machines.md)
- [Разработка Timeline Studio](../../DEV.md)
