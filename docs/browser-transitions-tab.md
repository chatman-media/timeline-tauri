# Документация по вкладке Переходов (Transitions Tab)

## Общее описание

Вкладка Переходов является одной из основных вкладок компонента Browser в приложении Timeline Studio. Она предоставляет интерфейс для просмотра, поиска, фильтрации и выбора переходов между клипами, которые можно добавить на временную шкалу проекта. Переходы позволяют создавать плавные или эффектные смены между различными медиа-элементами на таймлайне.

## Структура файлов

```
src/features/browser/components/tabs/transitions/
├── index.tsx                  # Экспорт компонентов вкладки
├── transition-list.tsx        # Основной компонент списка переходов
├── transition-preview.tsx     # Компонент предпросмотра перехода
├── transition-toolbar.tsx     # Панель инструментов для переходов
└── transitions.ts             # Типы и утилиты для работы с переходами
```

## Хуки

### usePreviewSize (`preview-size-provider.tsx`)

Вкладка Переходов использует общий хук `usePreviewSize` из директории `src/features/browser/components/preview/` для управления размером превью.

**Пример использования:**
```tsx
const {
  previewSize,
  increaseSize,
  decreaseSize,
  canIncreaseSize,
  canDecreaseSize,
} = usePreviewSize();
```

## Компоненты

### TransitionsList (`transition-list.tsx`)

Основной компонент для отображения списка переходов.

**Пропсы:**
- `onSelect` - функция, вызываемая при выборе перехода

**Состояние:**
- `transitions` - список переходов
- `searchQuery` - текущий поисковый запрос
- `showFavoritesOnly` - флаг отображения только избранных переходов

**Функциональность:**
- Отображение списка переходов с превью
- Группировка переходов по категориям
- Поиск переходов по названию
- Фильтрация по избранным переходам
- Изменение размера превью
- Добавление переходов на временную шкалу при клике

### TransitionPreview (`transition-preview.tsx`)

Компонент для отображения превью перехода.

**Пропсы:**
- `transition` - объект перехода
- `size` - размер превью
- `onClick` - функция, вызываемая при клике на превью

**Функциональность:**
- Отображение превью перехода (обычно в виде анимированного GIF или статического изображения)
- Отображение информации о переходе (название, длительность)
- Обработка клика для добавления перехода на временную шкалу

### TransitionToolbar (`transition-toolbar.tsx`)

Компонент панели инструментов для вкладки переходов.

**Пропсы:**
- `searchQuery` - текущий поисковый запрос
- `onSearchChange` - функция изменения поискового запроса
- `showFavoritesOnly` - флаг отображения только избранных переходов
- `onToggleFavorites` - функция переключения отображения избранных переходов
- `canIncreaseSize` - можно ли увеличить размер превью
- `canDecreaseSize` - можно ли уменьшить размер превью
- `handleIncreaseSize` - функция увеличения размера превью
- `handleDecreaseSize` - функция уменьшения размера превью

**Функциональность:**
- Поле поиска переходов
- Кнопка переключения отображения избранных переходов
- Кнопки изменения размера превью

## Типы и интерфейсы

### Transition (`transitions.ts`)

Интерфейс, описывающий переход.

```typescript
interface Transition {
  id: string;                // Уникальный идентификатор перехода
  name: string;              // Название перехода
  category: string;          // Категория перехода
  previewUrl: string;        // URL превью перехода
  duration: number;          // Длительность перехода в секундах
  isFavorite?: boolean;      // Флаг избранного перехода
  description?: string;      // Описание перехода
  tags?: string[];           // Теги перехода для поиска
  parameters?: {             // Параметры перехода, которые можно настраивать
    [key: string]: any;
  };
}
```

### TransitionCategory (`transitions.ts`)

Интерфейс, описывающий категорию переходов.

```typescript
interface TransitionCategory {
  id: string;                // Уникальный идентификатор категории
  name: string;              // Название категории
  description?: string;      // Описание категории
  transitions: Transition[]; // Список переходов в категории
}
```

## Интеграция с другими компонентами

### Интеграция с Preview Size

Вкладка Переходов использует общий механизм управления размером превью, реализованный в виде хука `usePreviewSize` из директории `src/features/browser/components/preview/`.

### Интеграция с Timeline

Вкладка Переходов интегрируется с компонентом Timeline для:
- Добавления выбранных переходов между клипами на временной шкале
- Обновления параметров переходов на временной шкале

## Особенности реализации

### Предпросмотр переходов

Предпросмотр переходов может быть реализован различными способами:
1. Статическое изображение с визуализацией эффекта перехода
2. Анимированный GIF, демонстрирующий эффект перехода
3. Интерактивный предпросмотр с использованием WebGL или Canvas для рендеринга эффекта в реальном времени

В текущей реализации используется подход с анимированными GIF для простоты и совместимости.

### Категории переходов

Переходы группируются по категориям для удобства навигации:
- Fade (Затухание) - плавные переходы с использованием прозрачности
- Wipe (Вытеснение) - переходы с геометрическими формами
- Slide (Скольжение) - переходы с движением
- Zoom (Масштабирование) - переходы с изменением масштаба
- 3D - переходы с трехмерными эффектами
- Glitch (Глитч) - переходы с эффектами искажения
- и другие

## Примеры использования

### Инициализация вкладки Переходов

```tsx
// В компоненте Browser
import { TransitionsList } from "./tabs/transitions";

function Browser() {
  // Функция для добавления перехода на временную шкалу
  const handleTransitionSelect = (transition) => {
    // Логика добавления перехода на таймлайн
    console.log("Selected transition:", transition);
  };

  return (
    <div className="browser">
      <TransitionsList onSelect={handleTransitionSelect} />
    </div>
  );
}
```

### Фильтрация переходов

```tsx
// В компоненте TransitionsList
const [searchQuery, setSearchQuery] = useState("");
const [showFavoritesOnly, setShowFavoritesOnly] = useState(false);

// Фильтрация по поисковому запросу
const filteredTransitions = transitions.filter(transition => 
  transition.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
  transition.tags?.some(tag => tag.toLowerCase().includes(searchQuery.toLowerCase()))
);

// Фильтрация по избранным
const favoriteTransitions = showFavoritesOnly 
  ? filteredTransitions.filter(transition => transition.isFavorite)
  : filteredTransitions;
```

### Изменение размера превью

```tsx
// В компоненте TransitionToolbar
const { increaseSize, decreaseSize, canIncreaseSize, canDecreaseSize } = usePreviewSize();

// Увеличение размера превью
const handleZoomIn = () => {
  if (canIncreaseSize) {
    increaseSize();
  }
};

// Уменьшение размера превью
const handleZoomOut = () => {
  if (canDecreaseSize) {
    decreaseSize();
  }
};
```

## Расширение функциональности

### Добавление новой категории переходов

1. Добавить новую категорию в список категорий в `transitions.ts`
2. Создать переходы для новой категории
3. Обновить компонент `transition-list.tsx` для отображения новой категории

### Добавление параметров настройки переходов

1. Обновить интерфейс `Transition` в `transitions.ts`, добавив новые параметры
2. Создать компонент для настройки параметров перехода
3. Интегрировать компонент настройки с временной шкалой

### Реализация интерактивного предпросмотра

1. Создать компонент для интерактивного предпросмотра с использованием WebGL или Canvas
2. Обновить компонент `transition-preview.tsx` для использования интерактивного предпросмотра
3. Добавить логику для рендеринга эффекта перехода в реальном времени

## Тестирование

Для тестирования компонентов вкладки Переходов используются следующие подходы:

1. **Модульные тесты** - для проверки отдельных компонентов и функций
2. **Интеграционные тесты** - для проверки взаимодействия компонентов
3. **Снимки (snapshots)** - для контроля визуального представления компонентов

Примеры тестов можно найти в файле `transition-list.test.tsx`.
