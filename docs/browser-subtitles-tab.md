# Документация по вкладке Субтитров (Subtitles Tab)

## Общее описание

Вкладка Субтитров является одной из вкладок компонента Browser в приложении Timeline Studio. Она предназначена для просмотра, поиска и выбора стилей субтитров, которые можно добавить на временную шкалу проекта. Субтитры позволяют добавлять текст к видео с различными стилями оформления.

> **Примечание**: Вкладка субтитров находится в процессе разработки (TODO) и может быть не полностью функциональна в текущей версии приложения.

## Структура файлов

```
src/features/browser/components/tabs/subtitles/
├── index.tsx                  # Экспорт компонентов вкладки
├── subtitles-list.tsx         # Основной компонент списка субтитров
├── subtitles-preview.tsx      # Компонент предпросмотра субтитров
└── subtitles.ts               # Типы и утилиты для работы с субтитрами
```

## Хуки

### usePreviewSize (`preview-size-provider.tsx`)

Вкладка Субтитров использует общий хук `usePreviewSize` из директории `src/features/browser/components/preview/` для управления размером превью.

**Пример использования:**
```tsx
const {
  previewSize,
  increaseSize,
  decreaseSize,
  canIncreaseSize,
  canDecreaseSize,
} = usePreviewSize();
```

## Компоненты

### SubtitlesList (`subtitles-list.tsx`)

Основной компонент для отображения списка стилей субтитров.

**Пропсы:**
- Нет внешних пропсов, все данные получаются из контекста

**Состояние:**
- `subtitleStyles` - список стилей субтитров
- `searchQuery` - текущий поисковый запрос
- `showFavoritesOnly` - флаг отображения только избранных стилей

**Функциональность (планируемая):**
- Отображение списка доступных стилей субтитров с превью
- Группировка стилей по категориям
- Поиск стилей по названию
- Фильтрация по избранным стилям
- Изменение размера превью
- Добавление субтитров на временную шкалу при клике

### SubtitlesPreview (`subtitles-preview.tsx`)

Компонент для отображения превью стиля субтитров.

**Пропсы:**
- `style` - объект стиля субтитров
- `size` - размер превью
- `onClick` - функция, вызываемая при клике на превью

**Функциональность (планируемая):**
- Отображение превью стиля субтитров с примером текста
- Отображение информации о стиле (название, категория)
- Обработка клика для добавления субтитров на временную шкалу

## Типы и интерфейсы

### SubtitleStyle (`subtitles.ts`)

Интерфейс, описывающий стиль субтитров.

```typescript
interface SubtitleStyle {
  id: string;                // Уникальный идентификатор стиля
  name: string;              // Название стиля
  category: string;          // Категория стиля
  previewUrl?: string;       // URL превью стиля
  isFavorite?: boolean;      // Флаг избранного стиля
  description?: string;      // Описание стиля
  fontFamily: string;        // Семейство шрифта
  fontSize: number;          // Размер шрифта
  fontWeight: string | number; // Жирность шрифта
  fontStyle: string;         // Стиль шрифта (normal, italic)
  color: string;             // Цвет текста
  backgroundColor?: string;  // Цвет фона
  textShadow?: string;       // Тень текста
  letterSpacing?: number;    // Межбуквенное расстояние
  lineHeight?: number;       // Высота строки
  textAlign?: string;        // Выравнивание текста
  padding?: string | number; // Отступы
  borderRadius?: string | number; // Скругление углов фона
  animation?: string;        // Анимация появления/исчезновения
}
```

### SubtitleCategory (`subtitles.ts`)

Интерфейс, описывающий категорию стилей субтитров.

```typescript
interface SubtitleCategory {
  id: string;                // Уникальный идентификатор категории
  name: string;              // Название категории
  description?: string;      // Описание категории
  styles: SubtitleStyle[];   // Список стилей в категории
}
```

## Интеграция с другими компонентами

### Интеграция с Preview Size

Вкладка Субтитров использует общий механизм управления размером превью, реализованный в виде хука `usePreviewSize` из директории `src/features/browser/components/preview/`.

### Интеграция с Timeline

Вкладка Субтитров интегрируется с компонентом Timeline для:
- Добавления выбранных стилей субтитров на временную шкалу
- Редактирования текста субтитров на временной шкале
- Настройки времени отображения субтитров

## Особенности реализации

### Предпросмотр стилей субтитров

Предпросмотр стилей субтитров может быть реализован различными способами:
1. Статическое изображение с примером текста в выбранном стиле
2. Динамический рендеринг текста с применением CSS-стилей
3. Интерактивный предпросмотр с возможностью редактирования текста

В планируемой реализации предполагается использовать динамический рендеринг текста с применением CSS-стилей для более точного отображения.

### Категории стилей субтитров

Стили субтитров могут группироваться по категориям для удобства навигации:
- Basic (Базовые) - простые стили без сложного оформления
- Cinematic (Кинематографические) - стили, имитирующие субтитры в фильмах
- Animated (Анимированные) - стили с анимацией появления/исчезновения
- Stylized (Стилизованные) - стили с художественным оформлением
- и другие

## Планируемая функциональность

### Основные возможности

- Отображение списка доступных стилей субтитров
- Предпросмотр стилей субтитров
- Изменение размера превью
- Добавление субтитров на временную шкалу
- Редактирование текста субтитров
- Настройка времени отображения субтитров

### Расширенные возможности

- Создание пользовательских стилей субтитров
- Импорт субтитров из файлов SRT, VTT
- Автоматическое распознавание речи для создания субтитров
- Перевод субтитров на другие языки
- Синхронизация субтитров с аудиодорожкой

## Примеры использования (планируемые)

### Инициализация вкладки Субтитров

```tsx
// В компоненте Browser
import { SubtitlesList } from "./tabs/subtitles";

function Browser() {
  return (
    <div className="browser">
      <SubtitlesList />
    </div>
  );
}
```

### Фильтрация стилей субтитров

```tsx
// В компоненте SubtitlesList
const [searchQuery, setSearchQuery] = useState("");
const [showFavoritesOnly, setShowFavoritesOnly] = useState(false);

// Фильтрация по поисковому запросу
const filteredStyles = subtitleStyles.filter(style => 
  style.name.toLowerCase().includes(searchQuery.toLowerCase())
);

// Фильтрация по избранным
const favoriteStyles = showFavoritesOnly 
  ? filteredStyles.filter(style => style.isFavorite)
  : filteredStyles;
```

### Изменение размера превью

```tsx
// В компоненте SubtitlesToolbar
const { increaseSize, decreaseSize, canIncreaseSize, canDecreaseSize } = usePreviewSize();

// Увеличение размера превью
const handleZoomIn = () => {
  if (canIncreaseSize) {
    increaseSize();
  }
};

// Уменьшение размера превью
const handleZoomOut = () => {
  if (canDecreaseSize) {
    decreaseSize();
  }
};
```

## Тестирование (планируемое)

Для тестирования компонентов вкладки Субтитров планируется использовать следующие подходы:

1. **Модульные тесты** - для проверки отдельных компонентов и функций
2. **Интеграционные тесты** - для проверки взаимодействия компонентов
3. **Снимки (snapshots)** - для контроля визуального представления компонентов

## Примечания для разработчиков

- Вкладка Субтитров находится в процессе разработки (TODO)
- При реализации учитывайте необходимость поддержки различных языков и направлений текста
- Для стилей с анимацией учитывайте производительность на мобильных устройствах
- Рассмотрите возможность интеграции с API распознавания речи для автоматического создания субтитров
